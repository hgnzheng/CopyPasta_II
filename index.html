<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="Deformable Neural Radiance Fields creates free-viewpoint portraits (nerfies) from casually captured videos.">
  <meta name="keywords" content="Nerfies, D-NeRF, NeRF">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Surgery's Pulse: Animated Biosensor Dashboard</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <link rel="stylesheet" href="https://nerfies.github.io/static/css/bulma.min.css">
  <link rel="stylesheet" href="https://nerfies.github.io/static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="https://nerfies.github.io/static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="https://nerfies.github.io/static/css/index.css">
  <link rel="stylesheet" href="style.css">
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Surgery's Pulse: Animated Biosensor Dashboard</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="">Hargen Zheng</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="">Travis Wu</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="">Kaijie Zhang</a><sup>1</sup>,
            </span>
            <span class="author-block">
                <a href="">Rihui Ling</a><sup>1</sup>,
              </span>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of San Diego,</span>
          </div>
          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- [No structural changes here] -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <h2 class="subtitle has-text-centered">
        This is the final project for DSC106-WI25.
      </h2>
    </div>
  </div>
</section>

<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="dashboard-view">
        <!-- (1) Top controls: case/track selection -->
        <div id="controls-top">
          <div class="caseSelector">
            <label for="caseSelector">Select Case:</label>
            <select id="caseSelector"></select>
          </div>
          <div class="trackSelector">
            <label for="trackSelector">Select Track:</label>
            <select id="trackSelector"></select>
          </div>
          <div class="labToggle">
            <label for="labToggle">Show Lab Results:</label>
            <input type="checkbox" id="labToggle" />
          </div>
        </div>

        <!-- (2) Lab results panel (hidden by default) -->
        <div id="labResults">
          <h3>Lab Results</h3>
          <table id="labTable"></table>
        </div>

        <!-- (3) Chart container + playback controls -->
        <div id="chart-container">
          <div id="chart"></div>
          <div id="controls">
            <button id="rewind"><i class="fas fa-backward"></i> Rewind</button>
            <button id="play"><i class="fas fa-play"></i> Play</button>
            <button id="pause"><i class="fas fa-pause"></i> Pause</button>
            <button id="fastForward"><i class="fas fa-forward"></i> Fast Forward</button>

            <label for="scrubber">Scrub:</label>
            <input type="range" id="scrubber" min="0" max="100" value="0" step="1" />

            <label for="speed">Speed:</label>
            <select id="speed">
              <option value="0.5">0.5x</option>
              <option value="1" selected>1x</option>
              <option value="2">2x</option>
            </select>

            <label for="MAdropdownMenu">Show MA:</label>
            <select id="MAdropdownMenu">
              <option value="none">None</option>
              <option value="1min">1 min</option>
              <option value="5min">5 min</option>
              <option value="both">Both</option>
            </select>
          </div>
        </div>

        <!-- (5) Overview timeline container -->
        <div id="overview">
          <button id="clearBrush">Clear Selection</button>
        </div>
      </div>

      <!-- Scripts for dashboard -->
      <script src="./data_api.js"></script>
      <script src="./dashboard.js"></script>
      <script src="./overviewTimeline.js"></script>
      <script>
        // Toggle lab results visibility
        document.getElementById('labToggle').addEventListener('change', function() {
          document.getElementById('labResults').style.display = this.checked ? 'block' : 'none';
        });

        // Listen for URL parameters on page load to handle returns from crisis view
        document.addEventListener('DOMContentLoaded', function() {
          const urlParams = new URLSearchParams(window.location.search);
          const caseId = urlParams.get('caseId');
          const time = urlParams.get('time');
          
          if (caseId) {
            // If we have a caseId parameter, select that case
            setTimeout(() => {
              const caseSelect = document.getElementById('caseSelector');
              if (caseSelect && caseSelect.options.length > 0) {
                for (let i = 0; i < caseSelect.options.length; i++) {
                  if (caseSelect.options[i].value == caseId) {
                    caseSelect.selectedIndex = i;
                    caseSelect.dispatchEvent(new Event('change'));
                    break;
                  }
                }
              }
              
              // If we also have a time parameter, set the current time
              if (time && typeof currentTime !== 'undefined') {
                setTimeout(() => {
                  currentTime = parseFloat(time);
                  updatePlayback();
                }, 500);
              }
            }, 500);
          }
        });
      </script>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3">Project Overview</h2>
    <div class="content has-text-justified">
      <p>
        The Surgery's Pulse dashboard visualizes real-time biosensor data from surgical procedures, 
        allowing physicians to track vital signs, detect anomalies, and simulate interventions for 
        better decision-making during critical moments.
      </p>
      <p>
        Key features include:
      </p>
      <ul>
        <li><strong>Animated Time-Series Visualization</strong>: Track vital signs with playback controls</li>
        <li><strong>Overview Timeline</strong>: Navigate through the entire surgery using brushing and linking</li>
        <li><strong>Anomaly Detection</strong>: Automatically identify and highlight critical events</li>
        <li><strong>Crisis Analysis</strong>: Deep-dive into critical moments with simulation capabilities</li>
      </ul>
      <p>
        Click on any anomaly marker or event annotation to enter the detailed crisis analysis view.
      </p>
    </div>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <p>
        Project developed by Hargen Zheng, Travis Wu, Kaijie Zhang, and Rihui Ling
      </p>
    </div>
  </div>
</footer>

<!-- Font Awesome for icons -->
<script src="https://kit.fontawesome.com/b070bb9e45.js" crossorigin="anonymous"></script>

</body>
</html>
